---
phase: 01-project-setup-infrastructure
plan: 04
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - backend/prisma/seed.ts
  - .github/workflows/ci.yml
  - README.md
autonomous: true

must_haves:
  truths:
    - "Prisma seed script creates realistic SA-themed sample data"
    - "CI pipeline runs backend tests and frontend build on push"
    - "README documents how to start the project with npm run dev"
    - "Seed data includes test user, master profile, experiences, skills, projects, education"
  artifacts:
    - path: "backend/prisma/seed.ts"
      provides: "Comprehensive SA-themed seed data for development"
      contains: "prisma.user.create"
    - path: ".github/workflows/ci.yml"
      provides: "GitHub Actions CI pipeline for backend tests and frontend build"
      contains: "npm test"
    - path: "README.md"
      provides: "Project setup documentation with commands and architecture overview"
      contains: "npm run dev"
  key_links:
    - from: "backend/prisma/seed.ts"
      to: "backend/prisma/schema.prisma"
      via: "uses Prisma Client generated from schema models"
      pattern: "prisma\\.(user|masterProfile|experience)"
    - from: ".github/workflows/ci.yml"
      to: "backend/package.json"
      via: "runs npm ci and npm test from backend directory"
      pattern: "working-directory.*backend"
---

<objective>
Create Prisma seed script with SA-themed sample data, GitHub Actions CI pipeline, and project README.

Purpose: Seed data enables immediate testing without manual data entry (critical for user's requirement to "see the app working immediately"). CI pipeline catches build/test failures early. README is the developer's entry point.
Output: Comprehensive seed script, working CI pipeline, and documentation.
</objective>

<execution_context>
@C:\Users\pc\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pc\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-project-setup-infrastructure/01-CONTEXT.md
@.planning/phases/01-project-setup-infrastructure/01-RESEARCH.md
@.planning/phases/01-project-setup-infrastructure/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Prisma seed script with SA-themed data</name>
  <files>
    backend/prisma/seed.ts
  </files>
  <action>
    Create a comprehensive seed script that populates the database with realistic South African sample data. This script must be idempotent (safe to run multiple times).

    Create backend/prisma/seed.ts:

    1. Import PrismaClient from @prisma/client
    2. Clear all existing data in reverse dependency order (GeneratedCV -> Job -> Certification -> Education -> Project -> Skill -> Experience -> MasterProfile -> User)
    3. Create test user:
       - email: "test@maxedcv.com"
       - name: "Sipho Ngwenya"
       - emailVerified: new Date() (already verified for testing convenience)
       - Document in console.log: "Test user: test@maxedcv.com"

    4. Create Master Profile for the test user with SA-themed data:
       - firstName: "Sipho", lastName: "Ngwenya"
       - email: "sipho.ngwenya@email.com", phone: "+27 82 123 4567"
       - location: "Cape Town, Western Cape, South Africa"
       - headline: "Senior Full-Stack Developer | TypeScript | React | Node.js"
       - summary: "Passionate software engineer with 5+ years building scalable web applications. Based in Cape Town with experience across fintech and e-commerce domains. Experienced in Agile methodologies and mentoring junior developers."
       - noticePeriod: "1 month" (SA-specific field)

    5. Create 3 Experience entries:
       a) Current: "Senior Full-Stack Developer" at "Yoco" (Cape Town, 2021-present)
          Bullet points:
          - "Architected microservices handling 100,000+ daily payment transactions using NestJS and PostgreSQL"
          - "Reduced API response times by 40% through query optimisation and Redis caching"
          - "Mentored 3 junior developers in TypeScript best practices and code review processes"
          - "Led migration from monolithic architecture to event-driven microservices"

       b) Previous: "Full-Stack Developer" at "Takealot" (Cape Town, 2019-2021)
          Bullet points:
          - "Built real-time inventory management system using React and Node.js serving 500+ sellers"
          - "Implemented search optimisation improving product conversion rate by 15%"
          - "Collaborated with product teams using Agile methodologies across 3 squads"
          - "Developed automated testing pipeline reducing bug reports by 30%"

       c) Earlier: "Junior Developer" at "OfferZen" (Cape Town, 2018-2019)
          Bullet points:
          - "Developed candidate matching algorithms using Python and PostgreSQL"
          - "Built responsive web interfaces using React and TypeScript"
          - "Participated in company-wide hackathons, winning Best Technical Innovation"

    6. Create Skills (9 items with categories):
       Languages: TypeScript, JavaScript, Python
       Frontend: React, Next.js
       Backend: Node.js, NestJS
       Databases: PostgreSQL
       DevOps: Docker

    7. Create 2 Projects:
       a) "SA Tourism Portal" -- Next.js tourism booking platform for Western Cape attractions. Technologies: Next.js, TypeScript, PostgreSQL, Stripe
       b) "Load Shedding Tracker" -- Real-time Eskom load shedding schedule app for SA residents. Technologies: React, Node.js, WebSocket, Redis

    8. Create 1 Education entry:
       - University of Cape Town, BSc Computer Science, 2015-2018

    9. Create 1 Certification:
       - "AWS Certified Solutions Architect - Associate", issuer: "Amazon Web Services", issueDate: 2023

    10. Create 1 Sample Job for testing (future phases):
        - title: "Senior TypeScript Developer"
        - company: "Discovery Limited"
        - location: "Johannesburg, Gauteng, South Africa"
        - url: "https://www.linkedin.com/jobs/view/example-123"
        - source: "linkedin"
        - description: A realistic 200+ word SA job description requiring TypeScript, React, Node.js, PostgreSQL, with mentions of "previously disadvantaged", BEE compliance, notice period requirements
        - requirements: ["TypeScript", "React", "Node.js", "PostgreSQL", "3+ years experience", "Agile methodology"]

    11. Log all created records with counts
    12. Handle errors with try/catch, disconnect in finally block

    Note: Use SA English throughout (organise not organize, optimise not optimize, favour not favor).
  </action>
  <verify>
    - backend/prisma/seed.ts exists and is non-empty
    - File imports PrismaClient
    - File contains "Sipho Ngwenya" (SA-themed test user)
    - File contains "Cape Town" (SA location)
    - File contains deleteMany calls for idempotency
    - File contains at least 3 experience.create calls
    - `cd backend && npx tsc --noEmit prisma/seed.ts` (or use ts-node --check) validates TypeScript syntax
  </verify>
  <done>
    Seed script creates: 1 test user (test@maxedcv.com), 1 master profile with SA data, 3 work experiences (Yoco, Takealot, OfferZen), 9 skills, 2 projects (SA Tourism Portal, Load Shedding Tracker), 1 education (UCT), 1 certification (AWS), 1 sample job (Discovery Limited). All data uses SA English and SA context.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CI pipeline and README</name>
  <files>
    .github/workflows/ci.yml
    README.md
  </files>
  <action>
    Create the GitHub Actions CI pipeline and project documentation.

    1. Create .github/workflows/ci.yml:

       name: CI
       on:
         push:
           branches: [main, master]
         pull_request:
           branches: [main, master]

       jobs:
         backend-test:
           runs-on: ubuntu-latest
           services:
             postgres:
               image: postgres:16-alpine
               env:
                 POSTGRES_USER: postgres
                 POSTGRES_PASSWORD: postgres
                 POSTGRES_DB: test
               options: >-
                 --health-cmd pg_isready
                 --health-interval 10s
                 --health-timeout 5s
                 --health-retries 5
               ports:
                 - 5432:5432
           steps:
             - uses: actions/checkout@v4
             - name: Setup Node.js
               uses: actions/setup-node@v4
               with:
                 node-version: '22'
                 cache: 'npm'
                 cache-dependency-path: backend/package-lock.json
             - name: Install dependencies
               working-directory: backend
               run: npm ci
             - name: Generate Prisma Client
               working-directory: backend
               run: npx prisma generate
             - name: Run migrations
               working-directory: backend
               env:
                 DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test
               run: npx prisma migrate deploy
             - name: Build
               working-directory: backend
               run: npm run build
             - name: Run tests
               working-directory: backend
               env:
                 DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test
                 NODE_ENV: test
               run: npm test -- --passWithNoTests

         frontend-build:
           runs-on: ubuntu-latest
           steps:
             - uses: actions/checkout@v4
             - name: Setup Node.js
               uses: actions/setup-node@v4
               with:
                 node-version: '22'
                 cache: 'npm'
                 cache-dependency-path: frontend/package-lock.json
             - name: Install dependencies
               working-directory: frontend
               run: npm ci
             - name: Build
               working-directory: frontend
               env:
                 NEXT_PUBLIC_API_URL: http://localhost:3001
               run: npm run build

    2. Create README.md at project root:

       # Maxed-CV

       AI-powered CV tailoring platform for the South African job market.

       ## What is Maxed-CV?

       Brief description: paste job URL, AI tailors your CV, download ATS-optimized PDF.

       ## Tech Stack

       - **Backend:** NestJS + PostgreSQL + Prisma ORM
       - **Frontend:** Next.js 14 (App Router)
       - **Infrastructure:** Docker + Docker Compose + Redis

       ## Prerequisites

       - Docker Desktop (with Docker Compose v2)
       - Node.js 22+ (for local development without Docker)
       - Git

       ## Quick Start

       ```bash
       # Clone the repository
       git clone <repo-url>
       cd maxed-cv

       # Start all services
       npm run dev

       # Access the application
       # Frontend: http://localhost:3000
       # Backend API: http://localhost:3001
       # Health check: http://localhost:3001/health
       ```

       ## Development Commands

       | Command | Description |
       |---------|-------------|
       | `npm run dev` | Start entire stack (frontend + backend + database + Redis) |
       | `npm run dev:build` | Start with fresh Docker builds |
       | `npm run backend` | Start only backend + database + Redis |
       | `npm run frontend` | Start only frontend |
       | `npm run stop` | Stop all services |
       | `npm run clean` | Stop all services and remove volumes (fresh start) |
       | `npm run db:migrate` | Run database migrations |
       | `npm run db:seed` | Seed sample data |
       | `npm run db:reset` | Reset database (drop + migrate + seed) |
       | `npm run db:studio` | Open Prisma Studio (database browser) |

       ## Test Account

       After seeding (`npm run db:seed`):
       - **Email:** test@maxedcv.com
       - **Name:** Sipho Ngwenya

       ## Project Structure

       ```
       maxed-cv/
       +-- backend/          # NestJS API (Port 3001)
       +-- frontend/         # Next.js App (Port 3000)
       +-- docker-compose.yml
       +-- package.json      # Root orchestration scripts
       ```

       ## Environment Variables

       Copy the example files:
       ```bash
       cp .env.example .env
       cp backend/.env.example backend/.env
       cp frontend/.env.local.example frontend/.env.local
       ```

       ## Architecture

       Brief description of service communication and data flow.

       ## License

       Private project.
  </action>
  <verify>
    - .github/workflows/ci.yml exists and contains 'npm test' and 'npm run build'
    - .github/workflows/ci.yml has both backend-test and frontend-build jobs
    - README.md exists and contains 'npm run dev' command
    - README.md documents test account credentials (test@maxedcv.com)
    - README.md lists all 6 required commands from user decisions
  </verify>
  <done>
    CI pipeline runs backend tests (with PostgreSQL service) and frontend build on push/PR to main. README documents all development commands, test account, project structure, and quick start instructions.
  </done>
</task>

</tasks>

<verification>
1. backend/prisma/seed.ts creates SA-themed data with 3 experiences, 9 skills, 2 projects, 1 education, 1 certification
2. .github/workflows/ci.yml defines backend-test and frontend-build jobs
3. README.md documents npm run dev, db:seed, db:migrate, db:reset commands
4. README.md includes test account credentials
5. Seed script is idempotent (deletes existing data before creating)
</verification>

<success_criteria>
- Seed script compiles and contains comprehensive SA-themed data matching CONTEXT.md requirements
- CI pipeline tests backend (with real PostgreSQL) and builds frontend
- README provides clear quick-start instructions for new developers
- All user-locked decisions about sample data are implemented (SA companies, SA English, test account documented)
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-setup-infrastructure/01-04-SUMMARY.md`
</output>
