---
phase: 03-master-profile-management
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/lib/validations/profile.ts
  - frontend/lib/skills-database.ts
  - frontend/types/profile.ts
  - frontend/lib/profile-api.ts
  - frontend/components/ui/dialog.tsx
  - frontend/components/ui/form.tsx
  - frontend/components/ui/input.tsx
  - frontend/components/ui/label.tsx
  - frontend/components/ui/button.tsx
  - frontend/components/ui/textarea.tsx
  - frontend/components/ui/badge.tsx
  - frontend/components.json
  - frontend/tailwind.config.ts
  - frontend/app/globals.css
autonomous: true

must_haves:
  truths:
    - "React Hook Form and dnd-kit packages installed in frontend"
    - "Zod validation schemas exist for all profile sections"
    - "TypeScript types defined for all profile data structures"
    - "Skills database file contains common skills with alias normalization"
    - "Profile API client functions exist for all CRUD operations"
    - "shadcn/ui base components (Dialog, Form, Input, Button, Badge) available"
  artifacts:
    - path: "frontend/lib/validations/profile.ts"
      provides: "Zod schemas for all profile sections"
      contains: "personalInfoSchema"
    - path: "frontend/types/profile.ts"
      provides: "TypeScript interfaces for profile data"
      contains: "MasterProfile"
    - path: "frontend/lib/skills-database.ts"
      provides: "Skills autocomplete data and normalization"
      contains: "COMMON_SKILLS"
    - path: "frontend/lib/profile-api.ts"
      provides: "API client for profile endpoints"
      contains: "profileAPI"
    - path: "frontend/components/ui/dialog.tsx"
      provides: "shadcn/ui Dialog component"
      contains: "Dialog"
  key_links:
    - from: "frontend/lib/validations/profile.ts"
      to: "frontend/types/profile.ts"
      via: "z.infer type inference"
      pattern: "z\\.infer"
    - from: "frontend/lib/profile-api.ts"
      to: "backend /profile endpoints"
      via: "fetch with credentials"
      pattern: "fetch.*profile"
---

<objective>
Install frontend dependencies, initialize shadcn/ui, and create all shared foundation files that profile components will use: TypeScript types, Zod validation schemas, skills database, and profile API client.

Purpose: Every profile component needs shared types, validation, API functions, and UI primitives. Building this foundation first prevents duplication and ensures consistency across all profile sections.
Output: Frontend packages installed, shadcn/ui initialized, shared files created for types/validation/API/skills.
</objective>

<execution_context>
@C:\Users\pc\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pc\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-master-profile-management/03-CONTEXT.md
@.planning/phases/03-master-profile-management/03-RESEARCH.md
@frontend/package.json
@frontend/app/layout.tsx
@frontend/app/globals.css
@frontend/lib/api.ts
@frontend/lib/auth.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and initialize shadcn/ui</name>
  <files>
    frontend/package.json
    frontend/components.json
    frontend/tailwind.config.ts
    frontend/app/globals.css
    frontend/components/ui/button.tsx
    frontend/components/ui/input.tsx
    frontend/components/ui/label.tsx
    frontend/components/ui/textarea.tsx
    frontend/components/ui/dialog.tsx
    frontend/components/ui/form.tsx
    frontend/components/ui/badge.tsx
  </files>
  <action>
**Step 1: Install npm packages**
```bash
cd frontend
npm install react-hook-form @hookform/resolvers
npm install @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
npm install date-fns
npm install tailwindcss postcss autoprefixer
```

Note: The project already has `zod` in package.json. Check if Tailwind is already configured. If not, initialize it:
```bash
npx tailwindcss init -p
```

**Step 2: Initialize shadcn/ui**
Run the shadcn/ui init command (use new-york style, default settings):
```bash
npx shadcn@latest init
```

If init is interactive and can't be automated, manually create `components.json` with:
```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
```

And create `lib/utils.ts` with the `cn` utility:
```typescript
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

Install clsx and tailwind-merge if needed:
```bash
npm install clsx tailwind-merge
```

**Step 3: Add shadcn/ui components**
```bash
npx shadcn@latest add button input label textarea dialog form badge
```

If the CLI doesn't work in the environment, manually create these components following shadcn/ui source code. Each component wraps Radix UI primitives with Tailwind classes.

**Important:** The existing app uses inline styles (no Tailwind). Adding Tailwind CSS MUST NOT break existing pages. Ensure `globals.css` adds Tailwind directives (`@tailwind base/components/utilities`) without removing existing styles. The existing inline styles on auth pages will continue to work alongside Tailwind.

Check that `tsconfig.json` has the `@/` path alias configured. If not, add:
```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./*"]
    }
  }
}
```
  </action>
  <verify>
1. `cd frontend && npm ls react-hook-form @dnd-kit/core date-fns` shows packages installed
2. `frontend/components/ui/dialog.tsx` exists
3. `frontend/components/ui/form.tsx` exists
4. `frontend/components/ui/button.tsx` exists
5. `cd frontend && npx tsc --noEmit` compiles without errors (or with only pre-existing errors)
  </verify>
  <done>
All frontend dependencies installed (react-hook-form, dnd-kit, date-fns). shadcn/ui initialized with Dialog, Form, Input, Label, Textarea, Button, Badge components. Tailwind CSS configured without breaking existing pages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared types, validation schemas, skills database, and profile API client</name>
  <files>
    frontend/types/profile.ts
    frontend/lib/validations/profile.ts
    frontend/lib/skills-database.ts
    frontend/lib/profile-api.ts
  </files>
  <action>
**frontend/types/profile.ts** - TypeScript interfaces matching backend response shapes:
```typescript
interface MasterProfile {
  id: string
  userId: string
  firstName: string
  lastName: string
  email: string
  phone: string | null
  location: string | null
  headline: string | null
  summary: string | null
  noticePeriod: string | null
  experiences: WorkExperience[]
  skills: ProfileSkill[]
  education: EducationEntry[]
  projects: ProjectEntry[]
  certifications: CertificationEntry[]
  createdAt: string
  updatedAt: string
}

interface WorkExperience {
  id: string
  jobTitle: string  // maps to 'position' on backend
  company: string
  location: string | null
  startDate: string
  endDate: string | null
  current: boolean
  bulletPoints: string[]
  order: number
}

interface ProfileSkill {
  id: string
  name: string
  order: number
}

interface EducationEntry {
  id: string
  institution: string
  degree: string
  fieldOfStudy: string | null
  startDate: string
  endDate: string | null
  order: number
}

interface ProjectEntry {
  id: string
  name: string
  description: string | null
  technologies: string[]
  url: string | null
  order: number
}

interface CertificationEntry {
  id: string
  name: string
  issuer: string
  issueDate: string | null
  credentialId: string | null
  order: number
}
```

**frontend/lib/validations/profile.ts** - Zod schemas for each form:

`personalInfoSchema`:
- firstName: string, min 1 max 100, required
- lastName: string, min 1 max 100, required
- email: string, email format, required
- phone: string, optional (allow empty)
- location: string, optional
- noticePeriod: string, optional (e.g., "Immediately", "1 month", "2 months", "3 months")
- bio: string, optional, max 500

`workExperienceSchema`:
- jobTitle: string, min 1, required
- company: string, min 1, required
- location: string, optional
- startDate: date (coerce), required
- endDate: date (coerce), optional
- current: boolean, default false
- bulletPoints: array of strings (min 1 char each), min 1 item
- Use `.refine()` for: if current is false and endDate exists, endDate > startDate. If current is true, endDate should be empty/null.

`educationSchema`:
- institution: string, required
- degree: string, required
- fieldOfStudy: string, optional
- startDate: date, required
- endDate: date, optional

`projectSchema`:
- name: string, required
- description: string, optional, max 1000
- technologies: string array
- url: string, optional, url format (when provided)

`certificationSchema`:
- name: string, required
- issuer: string, required
- issueDate: date, optional
- credentialId: string, optional

Export inferred types alongside schemas using `z.infer<typeof schema>`.

**frontend/lib/skills-database.ts** - Copy the skills database from RESEARCH.md:
- Export `COMMON_SKILLS` array (categorized: Programming Languages, Frontend, Backend, Databases, Cloud/DevOps, Tools, AI/ML, Data, Security)
- Export `SKILL_ALIASES` record mapping common abbreviations to canonical names
- Export `normalizeSkill(input: string): string` function
- Export `suggestSkills(input: string, limit?: number): string[]` function
- Include SA-specific skills: "POPIA Compliance", "BBBEE Compliance", "South African Tax", "Labour Relations Act"

**frontend/lib/profile-api.ts** - API client following the pattern from `lib/auth.ts`:
```typescript
const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';

export const profileAPI = {
  getProfile: () => fetch with credentials GET /profile,
  updatePersonalInfo: (data) => PATCH /profile/personal-info,
  addExperience: (data) => POST /profile/experience,
  updateExperience: (id, data) => PUT /profile/experience/:id,
  deleteExperience: (id) => DELETE /profile/experience/:id,
  addEducation: (data) => POST /profile/education,
  updateEducation: (id, data) => PUT /profile/education/:id,
  deleteEducation: (id) => DELETE /profile/education/:id,
  addProject: (data) => POST /profile/projects,
  updateProject: (id, data) => PUT /profile/projects/:id,
  deleteProject: (id) => DELETE /profile/projects/:id,
  addCertification: (data) => POST /profile/certifications,
  updateCertification: (id, data) => PUT /profile/certifications/:id,
  deleteCertification: (id) => DELETE /profile/certifications/:id,
  updateSkills: (skills) => PUT /profile/skills,
  reorderSection: (section, items) => PATCH /profile/reorder,
}
```

All methods should use `credentials: 'include'` for session cookies (match auth.ts pattern). Handle errors consistently: if !res.ok, parse error JSON and throw.
  </action>
  <verify>
1. `cd frontend && npx tsc --noEmit` compiles or check that the new files have no syntax errors
2. Verify `frontend/types/profile.ts` exports all interfaces
3. Verify `frontend/lib/validations/profile.ts` exports all Zod schemas
4. Verify `frontend/lib/skills-database.ts` exports COMMON_SKILLS, normalizeSkill, suggestSkills
5. Verify `frontend/lib/profile-api.ts` exports profileAPI with all CRUD methods
  </verify>
  <done>
Shared frontend foundation complete: TypeScript types for all profile entities, Zod validation schemas with date cross-validation, skills database with 70+ common skills and alias normalization, and profile API client with all CRUD methods matching backend endpoints.
  </done>
</task>

</tasks>

<verification>
1. All npm packages installed and listed in package.json
2. shadcn/ui components render without errors
3. TypeScript types match Prisma schema structure
4. Zod schemas validate correctly (date ranges, required fields)
5. Profile API client has methods for all 17 backend endpoints
6. Skills database returns suggestions when queried
</verification>

<success_criteria>
- `npm ls react-hook-form @dnd-kit/core date-fns` shows all installed
- shadcn/ui Dialog, Form, Button, Input, Badge components exist in components/ui/
- Types file exports MasterProfile, WorkExperience, ProfileSkill, EducationEntry, ProjectEntry, CertificationEntry
- Validation schemas export personalInfoSchema, workExperienceSchema, educationSchema, projectSchema, certificationSchema
- Skills database exports COMMON_SKILLS with 70+ entries and suggestSkills function
- Profile API client exports profileAPI with all CRUD methods
</success_criteria>

<output>
After completion, create `.planning/phases/03-master-profile-management/03-02-SUMMARY.md`
</output>
